import aiofiles
import struct
import lz4.block
import json
import os
from data.crypto.common import CustomCrypto, CryptoError
from typing import Literal, Any

# header: 
# magic value, compressed size, decompressed size, null bytes
# all 4 bytes long (little endian unsigned)
# json keys are obfuscated

class Crypt_NMS:
    LZ4_MAGIC = 0xFEEDA1E5
    CHUNK_SIZE = 0x80_000

    OBFUSCATION = {"libMBIN_version":"4.64.0.3","Mapping":[{"Key":"Iis","Value":"RealityIndex"},{"Key":"dZj","Value":"VoxelX"},{"Key":"IyE","Value":"VoxelY"},{"Key":"uXE","Value":"VoxelZ"},{"Key":"vby","Value":"SolarSystemIndex"},{"Key":"jsv","Value":"PlanetIndex"},{"Key":"oZw","Value":"GalacticAddress"},{"Key":"yhJ","Value":"UniverseAddress"},{"Key":"ux@","Value":"PreviousUniverseAddress"},{"Key":"QQp","Value":"HomeRealityIteration"},{"Key":">MX","Value":"Value"},{"Key":"n:R","Value":"SaveSummary"},{"Key":"7ND","Value":"DifficultyPresetType"},{"Key":"brJ","Value":"Preset"},{"Key":"qAf","Value":"EasiestUsedPreset"},{"Key":"4I:","Value":"HardestUsedPreset"},{"Key":"c=Q","Value":"SettingsLocked"},{"Key":"pS0","Value":"InventoriesAlwaysInRange"},{"Key":"eOL","Value":"AllSlotsUnlocked"},{"Key":"aw9","Value":"WarpDriveRequirements"},{"Key":"?Dt","Value":"CraftingIsFree"},{"Key":"G:V","Value":"TutorialEnabled"},{"Key":"2sL","Value":"StartWithAllItemsKnown"},{"Key":"uo4","Value":"BaseAutoPower"},{"Key":"q2@","Value":"DeathConsequencesDifficulty"},{"Key":"n7p","Value":"DeathConsequences"},{"Key":"cYk","Value":"DamageReceivedDifficulty"},{"Key":"hXp","Value":"DamageReceived"},{"Key":"mum","Value":"DamageGivenDifficulty"},{"Key":"PYQ","Value":"DamageGiven"},{"Key":"ZeS","Value":"ActiveSurvivalBarsDifficulty"},{"Key":"tEx","Value":"ActiveSurvivalBars"},{"Key":"ORx","Value":"HazardDrainDifficulty"},{"Key":"bGK","Value":"HazardDrain"},{"Key":"Dn>","Value":"EnergyDrainDifficulty"},{"Key":"A:s","Value":"EnergyDrain"},{"Key":"9JJ","Value":"SubstanceCollectionDifficulty"},{"Key":"jH@","Value":"SubstanceCollection"},{"Key":"?SS","Value":"InventoryStackLimitsDifficulty"},{"Key":"kZ5","Value":"InventoryStackLimits"},{"Key":"428","Value":"ChargingRequirementsDifficulty"},{"Key":"nhq","Value":"ChargingRequirements"},{"Key":"Eg1","Value":"FuelUseDifficulty"},{"Key":"jnM","Value":"FuelUse"},{"Key":"iqY","Value":"LaunchFuelCostDifficulty"},{"Key":"A9D","Value":"LaunchFuelCost"},{"Key":"Ubk","Value":"CurrencyCostDifficulty"},{"Key":"tsk","Value":"CurrencyCost"},{"Key":"TYf","Value":"ItemShopAvailabilityDifficulty"},{"Key":"FB5","Value":"ItemShopAvailability"},{"Key":"gFS","Value":"ScannerRechargeDifficulty"},{"Key":"Lf?","Value":"ScannerRecharge"},{"Key":"S@3","Value":"ReputationGainDifficulty"},{"Key":"vo>","Value":"ReputationGain"},{"Key":"1c;","Value":"CreatureHostilityDifficulty"},{"Key":"BbG","Value":"CreatureHostility"},{"Key":"ZbV","Value":"CombatTimerDifficultyOption"},{"Key":"Od7","Value":"SpaceCombatTimers"},{"Key":"jGh","Value":"GroundCombatTimers"},{"Key":"LT:","Value":"SprintingCostDifficulty"},{"Key":"l29","Value":"SprintingCost"},{"Key":"ef4","Value":"BreakTechOnDamageProbability"},{"Key":"gd>","Value":"BreakTechOnDamage"},{"Key":":fe","Value":"Settings"},{"Key":"LyC","Value":"DifficultyState"},{"Key":"b@r","Value":"TimeStamp"},{"Key":"elv","Value":"InventoryType"},{"Key":"Vn8","Value":"Type"},{"Key":"b2n","Value":"Id"},{"Key":"1o9","Value":"Amount"},{"Key":"F9q","Value":"MaxAmount"},{"Key":"eVk","Value":"DamageFactor"},{"Key":"b76","Value":"FullyInstalled"},{"Key":">Qh","Value":"X"},{"Key":"XJ>","Value":"Y"},{"Key":"3ZH","Value":"Index"},{"Key":":No","Value":"Slots"},{"Key":"hl?","Value":"ValidSlotIndices"},{"Key":"1o6","Value":"InventoryClass"},{"Key":"B@N","Value":"Class"},{"Key":"rri","Value":"InventoryStackSizeGroup"},{"Key":"WA4","Value":"StackSizeGroup"},{"Key":"QL1","Value":"BaseStatID"},{"Key":"@bB","Value":"BaseStatValues"},{"Key":"QA1","Value":"InventorySpecialSlotType"},{"Key":"MMm","Value":"SpecialSlots"},{"Key":"=Tb","Value":"Width"},{"Key":"N9>","Value":"Height"},{"Key":"iF:","Value":"IsCool"},{"Key":"NKm","Value":"Name"},{"Key":"F2P","Value":"Version"},{"Key":";l5","Value":"Inventory"},{"Key":"PMT","Value":"Inventory_TechOnly"},{"Key":"gan","Value":"Inventory_Cargo"},{"Key":"6<E","Value":"ShipInventory"},{"Key":"Kgt","Value":"WeaponInventory"},{"Key":"6pZ","Value":"ScreenScale"},{"Key":"jU1","Value":"x"},{"Key":"Uoj","Value":"y"},{"Key":"j22","Value":"z"},{"Key":"w?h","Value":"ScreenOffset"},{"Key":"6kQ","Value":"t"},{"Key":"dmU","Value":"ScreenRotation"},{"Key":"4Bv","Value":"WristScreenData"},{"Key":"@EL","Value":"Seed"},{"Key":";EM","Value":"UseSeedValue"},{"Key":"9;o","Value":"Level"},{"Key":"CA4","Value":"Layout"},{"Key":"OsQ","Value":"Store"},{"Key":"1Lx","Value":"ScreenData"},{"Key":"SMP","Value":"DescriptorGroups"},{"Key":"RVl","Value":"Palette"},{"Key":"Ty=","Value":"ColourAlt"},{"Key":"duU","Value":"R"},{"Key":"TEM","Value":"G"},{"Key":"txH","Value":"B"},{"Key":"g2;","Value":"A"},{"Key":"xEg","Value":"Colour"},{"Key":"Aak","Value":"Colours"},{"Key":"@6c","Value":"TextureOptionGroupName"},{"Key":"=Cv","Value":"TextureOptionName"},{"Key":"T>1","Value":"TextureOptions"},{"Key":"tIm","Value":"BoneName"},{"Key":"unY","Value":"Scale"},{"Key":"gsg","Value":"BoneScales"},{"Key":"7DH","Value":"CustomisationData"},{"Key":"OGV","Value":"IsLarge"},{"Key":"qVG","Value":"PrimaryMode"},{"Key":"jl;","Value":"SecondaryMode"},{"Key":"J<o","Value":"UseLegacyColours"},{"Key":"93M","Value":"Filename"},{"Key":"Aqw","Value":"ResourceID"},{"Key":"d6<","Value":"ResHandle"},{"Key":"QlJ","Value":"AltId"},{"Key":"jN4","Value":"Layer"},{"Key":"MYl","Value":"Group"},{"Key":"xIx","Value":"OverrideColour"},{"Key":"DE0","Value":"OptionName"},{"Key":"?=t","Value":"Options"},{"Key":"bnT","Value":"Samplers"},{"Key":"<d2","Value":"ProceduralTexture"},{"Key":"NTx","Value":"Resource"},{"Key":"SuJ","Value":"Multitools"},{"Key":"j3E","Value":"ActiveMultioolIndex"},{"Key":"XID","Value":"CreatureID"},{"Key":"osl","Value":"Descriptors"},{"Key":"WTp","Value":"CreatureSeed"},{"Key":"1p=","Value":"CreatureSecondarySeed"},{"Key":"m9o","Value":"SpeciesSeed"},{"Key":"JrL","Value":"GenusSeed"},{"Key":"HhX","Value":"CustomSpeciesName"},{"Key":"Q6I","Value":"Predator"},{"Key":"5L6","Value":"UA"},{"Key":"IaE","Value":"AllowUnmodifiedReroll"},{"Key":"uAX","Value":"ColourBaseSeed"},{"Key":"6fX","Value":"BoneScaleSeed"},{"Key":"?<V","Value":"HasFur"},{"Key":"8jm","Value":"Biome"},{"Key":"HbY","Value":"CreatureType"},{"Key":"XwC","Value":"BirthTime"},{"Key":"tDR","Value":"LastEggTime"},{"Key":"KY5","Value":"LastTrustIncreaseTime"},{"Key":"@Hb","Value":"LastTrustDecreaseTime"},{"Key":"eK9","Value":"EggModified"},{"Key":"WQX","Value":"HasBeenSummoned"},{"Key":"fH8","Value":"CustomName"},{"Key":"xDJ","Value":"Trust"},{"Key":"kL5","Value":"LocalID"},{"Key":"@lA","Value":"OnlineID"},{"Key":"OL5","Value":"Username"},{"Key":"8>q","Value":"Platform"},{"Key":"b1:","Value":"Timestamp"},{"Key":"ttq","Value":"SenderData"},{"Key":"JAy","Value":"Traits"},{"Key":"IEo","Value":"Moods"},{"Key":"Mcl","Value":"Pets"},{"Key":"uKZ","Value":"Eggs"},{"Key":"VFd","Value":"SelectedPreset"},{"Key":"wnR","Value":"CustomData"},{"Key":"8?J","Value":"Data"},{"Key":"j30","Value":"PetAccessoryCustomisation"},{"Key":"9Lg","Value":"UnlockedPetSlots"},{"Key":"4eu","Value":"GraveInventory"},{"Key":"BGQ","Value":"SpawnGrave"},{"Key":";JQ","Value":"SpaceGrave"},{"Key":"NFm","Value":"GraveUniverseAddress"},{"Key":"4ia","Value":"GravePosition"},{"Key":"gIh","Value":"GraveMatrixLookAt"},{"Key":"YJU","Value":"GraveMatrixUp"},{"Key":"rj2","Value":"ShipLayout"},{"Key":"xbM","Value":"WeaponLayout"},{"Key":"oJJ","Value":"CurrentShip"},{"Key":"NNR","Value":"GenerationSeed"},{"Key":"e6e","Value":"CurrentWeapon"},{"Key":"4kj","Value":"KnownTech"},{"Key":"eZ<","Value":"KnownProducts"},{"Key":"24<","Value":"KnownSpecials"},{"Key":"Ddk","Value":"KnownRefinerRecipes"},{"Key":"9wn","Value":"Word"},{"Key":"D;o","Value":"Races"},{"Key":":JX","Value":"KnownWords"},{"Key":"MF2","Value":"KnownWordGroups"},{"Key":"p0c","Value":"Mission"},{"Key":"tW6","Value":"Progress"},{"Key":"Kex","Value":"Stat"},{"Key":"5bU","Value":"BuildingSeed"},{"Key":"TWn","Value":"BuildingLocation"},{"Key":"M?f","Value":"ParticipantType"},{"Key":"eZ7","Value":"Participants"},{"Key":"dwb","Value":"MissionProgress"},{"Key":"?eS","Value":"PostMissionIndex"},{"Key":";R7","Value":"CurrentMissionID"},{"Key":"k?G","Value":"CurrentMissionSeed"},{"Key":"Mg<","Value":"PreviousMissionID"},{"Key":"rej","Value":"PreviousMissionSeed"},{"Key":"yq:","Value":"MissionVersion"},{"Key":"jGk","Value":"MissionID"},{"Key":"oF@","Value":"RecurrenceDeadline"},{"Key":"EQt","Value":"MissionRecurrences"},{"Key":"wMC","Value":"Position"},{"Key":"cmA","Value":"HoloExplorerInteraction"},{"Key":"<>B","Value":"HoloScepticInteraction"},{"Key":":=:","Value":"HoloNooneInteraction"},{"Key":"fSZ","Value":"Health"},{"Key":"KCM","Value":"ShipHealth"},{"Key":"kLc","Value":"Shield"},{"Key":"NE3","Value":"ShipShield"},{"Key":"dcK","Value":"Energy"},{"Key":"wGS","Value":"Units"},{"Key":"7QL","Value":"Nanites"},{"Key":"kN;","Value":"Specials"},{"Key":"i8O","Value":"TimeAlive"},{"Key":"9@i","Value":"Table"},{"Key":"FN5","Value":"Event"},{"Key":"iqv","Value":"BuildingClass"},{"Key":"ADw","Value":"Time"},{"Key":"1JW","Value":"MissionSeed"},{"Key":"A1f","Value":"MarkerStack"},{"Key":"i;<","Value":"NewMPMarkerStack"},{"Key":"CYJ","Value":"SurveyedEventPositions"},{"Key":"6Ws","Value":"NextSurveyedEventPositionIndex"},{"Key":"JBy","Value":"LastCheckedForStatResetsTime"},{"Key":":rc","Value":"GroupId"},{"Key":"2Ak","Value":"Address"},{"Key":">vs","Value":"IntValue"},{"Key":"eoL","Value":"FloatValue"},{"Key":"uOX","Value":"Denominator"},{"Key":"gUR","Value":"Stats"},{"Key":"m4I","Value":"TelemetryStats"},{"Key":"O49","Value":"Interactions"},{"Key":"Xf4","Value":"CurrentPos"},{"Key":"a6j","Value":"StoredInteractions"},{"Key":"=yU","Value":"InventoryContainer"},{"Key":"wx7","Value":"LastUpdateTimestamp"},{"Key":"eyv","Value":"LastCompletedTimestamp"},{"Key":"FML","Value":"LastBrokenTimestamp"},{"Key":"4>;","Value":"DamageTimers"},{"Key":"tIM","Value":"AmountAccumulators"},{"Key":"XV5","Value":"Flags"},{"Key":"RQA","Value":"MaintenanceInteractions"},{"Key":"VhC","Value":"PersonalMaintenanceInteractions"},{"Key":"nwS","Value":"VisitedSystems"},{"Key":"seg","Value":"Hazard"},{"Key":"9Lm","Value":"BoltAmmo"},{"Key":"VPy","Value":"ScatterAmmo"},{"Key":":ML","Value":"PulseAmmo"},{"Key":"cO>","Value":"LaserAmmo"},{"Key":"vaP","Value":"FirstSpawnPosition"},{"Key":"SEK","Value":"SavedRaceIndicies"},{"Key":"=4m","Value":"HasLoopedIndicies"},{"Key":"E?v","Value":"SavedInteractionIndicies"},{"Key":"E=X","Value":"Hash"},{"Key":"2Fk","Value":"Dialog"},{"Key":"Wu?","Value":"SavedInteractionDialogTable"},{"Key":"wHR","Value":"InteractionProgressTable"},{"Key":"vsV","Value":"AtlasStationAdressData"},{"Key":"B9>","Value":"NewAtlasStationAdressData"},{"Key":":A3","Value":"VisitedAtlasStationsData"},{"Key":":0x","Value":"FirstAtlasStationDiscovered"},{"Key":"x>0","Value":"CompletedAtlasAddresses"},{"Key":"DtI","Value":"ProgressionLevel"},{"Key":"QNH","Value":"ProcTechIndex"},{"Key":"eV1","Value":"IsNew"},{"Key":"wc3","Value":"UseSmallerBlackholeJumps"},{"Key":"M2L","Value":"EntitlementId"},{"Key":"<dk","Value":"UsedEntitlements"},{"Key":"aHM","Value":"PlanetPositions"},{"Key":"?=a","Value":"PlanetSeeds"},{"Key":"7Mc","Value":"PrimaryPlanet"},{"Key":"05J","Value":"TimeLastSpaceBattle"},{"Key":"8br","Value":"WarpsLastSpaceBattle"},{"Key":"8xx","Value":"ActiveSpaceBattleUA"},{"Key":"bQN","Value":"ActiveSpaceBattleLevel"},{"Key":"IRi","Value":"TimeLastMiniStation"},{"Key":"x=M","Value":"WarpsLastMiniStation"},{"Key":"gpU","Value":"MiniStationUA"},{"Key":"JvI","Value":"AnomalyPositionOverride"},{"Key":"5ST","Value":"GameStartAddress1"},{"Key":"EeN","Value":"GameStartAddress2"},{"Key":"M2Z","Value":"GalacticMapRequests"},{"Key":"nTB","Value":"FirstShipPosition"},{"Key":"G?:","Value":"HazardTimeAlive"},{"Key":"tSD","Value":"RevealBlackHoles"},{"Key":"kYq","Value":"CurrentFreighterHomeSystemSeed"},{"Key":"bIR","Value":"CurrentFreighter"},{"Key":">Yh","Value":"FreighterLayout"},{"Key":"pQJ","Value":"FreighterCargoLayout"},{"Key":"8ZP","Value":"FreighterInventory"},{"Key":"0wS","Value":"FreighterInventory_TechOnly"},{"Key":"FdP","Value":"FreighterInventory_Cargo"},{"Key":"G;q","Value":"FreighterLastSpawnTime"},{"Key":"RB7","Value":"FreighterUniverseAddress"},{"Key":"7:k","Value":"FreighterDismissed"},{"Key":"9wg","Value":"FreighterMatrixAt"},{"Key":"fUl","Value":"FreighterMatrixUp"},{"Key":"lpm","Value":"FreighterMatrixPos"},{"Key":"7?0","Value":"SquadronUnlockedPilotSlots"},{"Key":">r:","Value":"NPCResource"},{"Key":":dY","Value":"ShipResource"},{"Key":"=bJ","Value":"TraitsSeed"},{"Key":"yDG","Value":"PilotRank"},{"Key":"S5O","Value":"SquadronPilots"},{"Key":"qJ7","Value":"SeenBaseBuildingObjects"},{"Key":"r<7","Value":"ObjectID"},{"Key":"ofi","Value":"RegionSeed"},{"Key":"CVX","Value":"UserData"},{"Key":"wJ0","Value":"Up"},{"Key":"aNu","Value":"At"},{"Key":"c5s","Value":"BaseBuildingObjects"},{"Key":"r:j","Value":"GalacticAddresses"},{"Key":"eiy","Value":"BufferSizes"},{"Key":"w0G","Value":"BufferAges"},{"Key":"cL6","Value":"BufferAnchors"},{"Key":"deQ","Value":"BufferProtected"},{"Key":"Mes","Value":"Edits"},{"Key":"=o:","Value":"TerrainEditData"},{"Key":"q08","Value":"ResourceElement"},{"Key":"BKy","Value":"InteractionSeed"},{"Key":"1wj","Value":"HiredWorker"},{"Key":"gNy","Value":"FreighterBase"},{"Key":"pNt","Value":"BaseUA"},{"Key":"TJx","Value":"BaseOffset"},{"Key":"4Km","Value":"NPCWorkers"},{"Key":"h4X","Value":"BaseVersion"},{"Key":"BpT","Value":"OriginalBaseVersion"},{"Key":"oHw","Value":"Forward"},{"Key":"sHl","Value":"Message"},{"Key":"@ZJ","Value":"Objects"},{"Key":"B2h","Value":"RID"},{"Key":"3?K","Value":"Owner"},{"Key":"DPp","Value":"PersistentBaseTypes"},{"Key":"peI","Value":"BaseType"},{"Key":"J=S","Value":"LastEditedById"},{"Key":"vyN","Value":"LastEditedByUsername"},{"Key":"D9@","Value":"ScreenshotAt"},{"Key":"rIR","Value":"ScreenshotPos"},{"Key":"pwt","Value":"PresetGameMode"},{"Key":"idA","Value":"GameMode"},{"Key":"E7u","Value":"DifficultyPreset"},{"Key":"?<y","Value":"PersistentBaseDifficultyFlags"},{"Key":"6nS","Value":"Difficulty"},{"Key":"C0j","Value":"PlatformToken"},{"Key":"i4g","Value":"IsReported"},{"Key":"tww","Value":"IsFeatured"},{"Key":"cI>","Value":"BaseAutoPowerSetting"},{"Key":"6Ts","Value":"AutoPowerSetting"},{"Key":"F?0","Value":"PersistentPlayerBases"},{"Key":"gk4","Value":"Facing"},{"Key":"iAF","Value":"TeleporterType"},{"Key":"a>;","Value":"CalcWarpOffset"},{"Key":"nlG","Value":"TeleportEndpoints"},{"Key":"=3B","Value":"Chest1Layout"},{"Key":"3Nc","Value":"Chest1Inventory"},{"Key":"@ip","Value":"Chest2Layout"},{"Key":"IDc","Value":"Chest2Inventory"},{"Key":"@Ik","Value":"Chest3Layout"},{"Key":"M=:","Value":"Chest3Inventory"},{"Key":"@1E","Value":"Chest4Layout"},{"Key":"iYp","Value":"Chest4Inventory"},{"Key":"XgV","Value":"Chest5Layout"},{"Key":"<IP","Value":"Chest5Inventory"},{"Key":"nw5","Value":"Chest6Layout"},{"Key":"qYJ","Value":"Chest6Inventory"},{"Key":"tLo","Value":"Chest7Layout"},{"Key":"@e5","Value":"Chest7Inventory"},{"Key":"7b?","Value":"Chest8Layout"},{"Key":"5uh","Value":"Chest8Inventory"},{"Key":"QBc","Value":"Chest9Layout"},{"Key":"5Tg","Value":"Chest9Inventory"},{"Key":"wqf","Value":"Chest10Layout"},{"Key":"Bq<","Value":"Chest10Inventory"},{"Key":"v8;","Value":"ChestMagicLayout"},{"Key":";?C","Value":"ChestMagicInventory"},{"Key":"wFm","Value":"ChestMagic2Layout"},{"Key":"fCh","Value":"ChestMagic2Inventory"},{"Key":"RiP","Value":"CookingIngredientsLayout"},{"Key":"Kha","Value":"CookingIngredientsInventory"},{"Key":"UaL","Value":"RocketLockerLayout"},{"Key":"V86","Value":"RocketLockerInventory"},{"Key":"Sjw","Value":"CurrentFreighterNPC"},{"Key":"pMa","Value":"InventoryLayout"},{"Key":"YTa","Value":"Location"},{"Key":"l?l","Value":"Direction"},{"Key":"P;m","Value":"VehicleOwnership"},{"Key":"5sx","Value":"PrimaryVehicle"},{"Key":"@Cs","Value":"ShipOwnership"},{"Key":"aBE","Value":"PrimaryShip"},{"Key":"@Vn","Value":"MultiShipEnabled"},{"Key":"Agx","Value":"VehicleAIControlEnabled"},{"Key":"vxi","Value":"PlayerFreighterName"},{"Key":"h=c","Value":"StartGameShipPosition"},{"Key":"Bur","Value":"ShipNeedsTerrainPositioning"},{"Key":"nkF","Value":"TradingSupplyDataIndex"},{"Key":"Iu7","Value":"Supply"},{"Key":"pfp","Value":"Demand"},{"Key":"JWK","Value":"Product"},{"Key":"b69","Value":"TradingSupplyData"},{"Key":"3fO","Value":"PortalSeed"},{"Key":"K:U","Value":"LastPortalUA"},{"Key":"oEc","Value":"IsStoryPortal"},{"Key":"HbG","Value":"LastPortal"},{"Key":"NQJ","Value":"VisitedPortal"},{"Key":"vrS","Value":"KnownPortalRunes"},{"Key":"DaC","Value":"OnOtherSideOfPortal"},{"Key":"30s","Value":"OtherSideOfPortalReturnBase"},{"Key":"LIR","Value":"PortalMarkerPosition_Local"},{"Key":"qW;","Value":"PortalMarkerPosition_Offset"},{"Key":"Rfw","Value":"WeaponMode"},{"Key":";DM","Value":"StartingPrimaryWeapon"},{"Key":"SYl","Value":"StartingSecondaryWeapon"},{"Key":"l:j","Value":"CharacterCustomisationData"},{"Key":"4hl","Value":"ShipUsesLegacyColours"},{"Key":"cf5","Value":"Outfits"},{"Key":"5LX","Value":"JetpackEffect"},{"Key":"1@y","Value":"FreighterEngineEffect"},{"Key":"3Z>","Value":"FleetSeed"},{"Key":"SLc","Value":"ResourceSeed"},{"Key":"@ui","Value":"HomeSystemSeed"},{"Key":"=rR","Value":"ForcedTraitsSeed"},{"Key":"4kx","Value":"TimeOfLastIncomeCollection"},{"Key":"uw7","Value":"FrigateClass"},{"Key":"0Hi","Value":"AlienRace"},{"Key":"SS2","Value":"Race"},{"Key":"5es","Value":"TotalNumberOfExpeditions"},{"Key":"v=L","Value":"TotalNumberOfSuccessfulEvents"},{"Key":"5VG","Value":"TotalNumberOfFailedEvents"},{"Key":"MuL","Value":"NumberOfTimesDamaged"},{"Key":"Mjm","Value":"TraitIDs"},{"Key":"yJC","Value":"RepairsMade"},{"Key":"7hK","Value":"DamageTaken"},{"Key":";Du","Value":"FleetFrigates"},{"Key":"o@4","Value":"SpawnPosition"},{"Key":"4j2","Value":"TerminalPosition"},{"Key":"b>d","Value":"SpeedMultiplier"},{"Key":"hea","Value":"Powerups"},{"Key":"3oW","Value":"InterventionEventMissionID"},{"Key":"bc<","Value":"StartTime"},{"Key":"?DC","Value":"PauseTime"},{"Key":"dfZ","Value":"TimeOfLastUAChange"},{"Key":"U87","Value":"NextEventToTrigger"},{"Key":"xVB","Value":"ExpeditionCategory"},{"Key":"TPK","Value":"ExpeditionDuration"},{"Key":"sbg","Value":"ActiveFrigateIndices"},{"Key":"WZs","Value":"DamagedFrigateIndices"},{"Key":"1xe","Value":"DestroyedFrigateIndices"},{"Key":"lD@","Value":"AllFrigateIndices"},{"Key":"omN","Value":"NumberOfSuccessfulEventsThisExpedition"},{"Key":"G;H","Value":"NumberOfFailedEventsThisExpedition"},{"Key":"iaH","Value":"AffectedFrigateIndices"},{"Key":"QJG","Value":"RepairingFrigateIndices"},{"Key":"fe2","Value":"AffectedFrigateResponses"},{"Key":"Mx@","Value":"EventID"},{"Key":"7Q;","Value":"InterventionEventID"},{"Key":"U2F","Value":"OverriddenDescription"},{"Key":"SQw","Value":"WhaleEvent"},{"Key":"Naj","Value":"OverriddenReward"},{"Key":"W=a","Value":"OverriddenRewardDescription"},{"Key":"bbB","Value":"Success"},{"Key":"fvN","Value":"IsInterventionEvent"},{"Key":"8GD","Value":"AvoidedIntervention"},{"Key":"tUs","Value":"Events"},{"Key":"b78","Value":"InterventionPhoneCallActivated"},{"Key":"kw:","Value":"FleetExpeditions"},{"Key":"ieD","Value":"ExpeditionSeedsSelectedToday"},{"Key":"nxr","Value":"LastKnownDay"},{"Key":">db","Value":"SunTimer"},{"Key":"vXX","Value":"MultiplayerLobbyID"},{"Key":"YxD","Value":"MultiplayerUA"},{"Key":"mEH","Value":"PlayerPositionInSystem"},{"Key":"l2U","Value":"PlayerTransformAt"},{"Key":"tmM","Value":"PlayerDeathRespawnPositionInSystem"},{"Key":"PK0","Value":"PlayerDeathRespawnTransformAt"},{"Key":"tnP","Value":"ShipPositionInSystem"},{"Key":"l4H","Value":"ShipTransformAt"},{"Key":"jk4","Value":"LastKnownPlayerState"},{"Key":"NGn","Value":"FreighterPositionInSystem"},{"Key":"uAt","Value":"FreighterTransformAt"},{"Key":"5Sg","Value":"FreighterTransformUp"},{"Key":"Ovv","Value":"AbandonedFreighterPositionInSystem"},{"Key":"EkX","Value":"AbandonedFreighterTransformAt"},{"Key":"Bg3","Value":"AbandonedFreighterTransformUp"},{"Key":"x<b","Value":"MultiplayerSpawn"},{"Key":";YC","Value":"MaintenanceContainer"},{"Key":"D=h","Value":"InventorySubIndex"},{"Key":"WX8","Value":"InventoryIndex"},{"Key":"wyZ","Value":"RepairTechBuffer"},{"Key":"kpg","Value":"MultiplayerPrivileges"},{"Key":"<6x","Value":"QuickMenuActions"},{"Key":"TD8","Value":"Action"},{"Key":"Y5p","Value":"Number"},{"Key":"sM@","Value":"KeyActions"},{"Key":"k8N","Value":"HotActions"},{"Key":"8GF","Value":"LastUABeforePortalWarp"},{"Key":"7Un","Value":"StoryPortalSeed"},{"Key":"aPn","Value":"ShopNumber"},{"Key":"rk3","Value":"ShopTier"},{"Key":"Ue9","Value":"HasAccessToNexus"},{"Key":"hiE","Value":"NexusUniverseAddress"},{"Key":"Fk@","Value":"NexusMatrixAt"},{"Key":"d72","Value":"NexusMatrixUp"},{"Key":"Yel","Value":"NexusMatrixPos"},{"Key":"9hR","Value":"BannerIcon"},{"Key":"8DG","Value":"BannerMainColour"},{"Key":"lmE","Value":"BannerBackgroundColour"},{"Key":"aNF","Value":"BannerTitleId"},{"Key":"qFl","Value":"TelemetryUploadVersion"},{"Key":"T>Z","Value":"VRCameraOffset"},{"Key":"oQl","Value":"RestartAllInactiveSeasonalMissions"},{"Key":"FnB","Value":"RedeemedSeasonRewards"},{"Key":"0Pa","Value":"RedeemedTwitchRewards"},{"Key":"dgg","Value":"RedeemedPlatformRewards"},{"Key":"20I","Value":"UniqueId"},{"Key":"qK9","Value":"SeedValue"},{"Key":"d3x","Value":"BuildingStates"},{"Key":"3@T","Value":"LastBuildingUpgradesTimestamps"},{"Key":"?SU","Value":"SettlementJudgementType"},{"Key":"HMQ","Value":"PendingJudgementType"},{"Key":"Xs1","Value":"PendingCustomJudgementID"},{"Key":"OEf","Value":"Perks"},{"Key":"0Qr","Value":"LastJudgementTime"},{"Key":"OI3","Value":"LastUpkeepDebtCheckTime"},{"Key":"g<v","Value":"LastDebtChangeTime"},{"Key":"HWh","Value":"LastAlertChangeTime"},{"Key":"Kvr","Value":"DbResourceId"},{"Key":"hMW","Value":"DbTimestamp"},{"Key":"gEp","Value":"DbVersion"},{"Key":"CZw","Value":"ElementId"},{"Key":"6X1","Value":"LastChangeTimestamp"},{"Key":"abj","Value":"ProductionState"},{"Key":"hiD","Value":"NextBuildingUpgradeIndex"},{"Key":":Qn","Value":"NextBuildingUpgradeClass"},{"Key":"xru","Value":"NextBuildingUpgradeSeedValue"},{"Key":"GQA","Value":"SettlementStatesV2"},{"Key":"LsP","Value":"SettlementStateRingBufferIndexV2"},{"Key":"Sd6","Value":"NextLoadSpawnsWithFreshStart"},{"Key":"O;Y","Value":"PageIdx"},{"Key":"=Wk","Value":"LastSeenEntryIdx"},{"Key":"yF<","Value":"PagesData"},{"Key":"aVB","Value":"SeenStories"},{"Key":"cPt","Value":"BuildersKnown"},{"Key":"6UA","Value":"StartingSeasonNumber"},{"Key":"UqY","Value":"GenerationID"},{"Key":"1OQ","Value":"WonderStatValue"},{"Key":"y87","Value":"SeenInFrontend"},{"Key":"dgD","Value":"WonderPlanetRecords"},{"Key":"MZ1","Value":"WonderCreatureRecords"},{"Key":"fp9","Value":"WonderFloraRecords"},{"Key":"bYs","Value":"WonderMineralRecords"},{"Key":"e?Y","Value":"WonderTreasureRecords"},{"Key":"<8Q","Value":"WonderWeirdBasePartRecords"},{"Key":"Svy","Value":"WonderCustomRecords"},{"Key":"93I","Value":"WonderType"},{"Key":"7bp","Value":"ActualType"},{"Key":"YvA","Value":"WonderCustomRecordsExtraData"},{"Key":"?n7","Value":"SpaceAddress"},{"Key":"heA","Value":"OwnerOnlineId"},{"Key":"tj1","Value":"OwnerPlatformId"},{"Key":"yqB","Value":"BufferVersion"},{"Key":"Qb3","Value":"ItemsCount"},{"Key":"DtV","Value":"SyncBuffersData"},{"Key":"oR8","Value":"RefinerBufferKeys"},{"Key":"XeZ","Value":"RefinerBufferData"},{"Key":"S8b","Value":"GalaxyWaypointType"},{"Key":"SSo","Value":"EventId"},{"Key":"JMB","Value":"GalaxyWaypoints"},{"Key":"XTp","Value":"ActiveContext"},{"Key":"fgt","Value":"ReserveStore"},{"Key":"xxK","Value":"ReserveManaged"},{"Key":"<h0","Value":"CommonStateData"},{"Key":"Pk4","Value":"SaveName"},{"Key":"Lg8","Value":"TotalPlayTime"},{"Key":"kPF","Value":"UsesThirdPersonCharacterCam"},{"Key":"wb:","Value":"UsesThirdPersonVehicleCam"},{"Key":"Wh<","Value":"UsesThirdPersonShipCam"},{"Key":"qAx","Value":"Fog"},{"Key":"22a","Value":"CloudAmount"},{"Key":"qLk","Value":"SunDir"},{"Key":"yGF","Value":"FoV"},{"Key":"0tA","Value":"DepthOfFieldSetting"},{"Key":"RUO","Value":"DepthOfFieldDistance"},{"Key":"yuu","Value":"DepthOfFieldDistanceSpace"},{"Key":"n0h","Value":"HalfFocalPlaneDepth"},{"Key":">xF","Value":"HalfFocalPlaneDepthSpace"},{"Key":"0L0","Value":"DepthOfFieldPhysConvergence"},{"Key":"HfT","Value":"DepthOfFieldPhysAperture"},{"Key":"L85","Value":"Vignette"},{"Key":"HJQ","Value":"Filter"},{"Key":"FQ3","Value":"Bloom"},{"Key":"j3Y","Value":"PhotoModeSettings"},{"Key":"Wv?","Value":"RequiredSpecialId"},{"Key":"ATe","Value":"LocID"},{"Key":"m7b","Value":"AuthorOnlineID"},{"Key":"4ha","Value":"AuthorUsername"},{"Key":"d2f","Value":"AuthorPlatform"},{"Key":"ON4","Value":"MySongs"},{"Key":"V1o","Value":"Playlist"},{"Key":"s8f","Value":"Shuffle"},{"Key":"1Zr","Value":"AutoplayOnFoot"},{"Key":"Qyw","Value":"AutoplayInShip"},{"Key":"LgS","Value":"AutoplayInVehicle"},{"Key":"8iI","Value":"ByteBeatLibrary"},{"Key":"gou","Value":"SeasonId"},{"Key":"hyA","Value":"StartTimeUTC"},{"Key":"jqx","Value":"EndTimeUTC"},{"Key":"8wT","Value":"Title"},{"Key":"GLf","Value":"Subtitle"},{"Key":"myI","Value":"Description"},{"Key":"9iD","Value":"Summary"},{"Key":"F=4","Value":"FinalStageTitle"},{"Key":"Rf8","Value":"MilestoneWithStageLocId"},{"Key":"xSo","Value":"AkEvent"},{"Key":"XEk","Value":"SeasonStartMusicOverride"},{"Key":"<Aw","Value":"BlockFirstSpaceMusic"},{"Key":"bSn","Value":"DifficultySettingPreset"},{"Key":"JiM","Value":"DifficultyMinimums"},{"Key":"C03","Value":"CreateContextSaveDataMask"},{"Key":"SnZ","Value":"SwitchContextSaveDataMask"},{"Key":"8sY","Value":"SeasonalUAOverride"},{"Key":"GPe","Value":"UAOverrideValue"},{"Key":"GME","Value":"FinalReward"},{"Key":"To;","Value":"FinalRewardSwitchAlt"},{"Key":"0bY","Value":"FinalCantRewardMessage"},{"Key":"Fgx","Value":"FinalRewardDescription"},{"Key":"KlW","Value":"MainIcon"},{"Key":">dq","Value":"SeasonNumber"},{"Key":">CR","Value":"RemixNumber"},{"Key":"oew","Value":"DisplayNumber"},{"Key":"pU@","Value":"SeasonName"},{"Key":"HE0","Value":"SeasonNameUpper"},{"Key":"Whh","Value":"MainMissionTitle"},{"Key":"i1<","Value":"MainMissionMessage"},{"Key":"6Mq","Value":"DoCommunityMissionTextSubstitutions"},{"Key":"G0<","Value":"CommunityProgressTitle"},{"Key":"::o","Value":"CommunityTierLabel"},{"Key":"Z=p","Value":"CommunityTierProgressLabel"},{"Key":"cjs","Value":"CommunityTierCompleteLabel"},{"Key":">JB","Value":"DefaultToPvPOff"},{"Key":"PSw","Value":"MustCraftInBases"},{"Key":"s2L","Value":"AdditionalTradeProducts"},{"Key":"dgv","Value":"NeverTradeProducts"},{"Key":"rRe","Value":"Image"},{"Key":"tdR","Value":"TakeImageFromItemIcon"},{"Key":"V7R","Value":"AudioEvent"},{"Key":"ASZ","Value":"Text"},{"Key":"XvU","Value":"PointState"},{"Key":"IsE","Value":"InsertItemName"},{"Key":"NS6","Value":"Points"},{"Key":"MN0","Value":"TakeDataFromSeason"},{"Key":"Pa4","Value":"DebugText"},{"Key":"apL","Value":"InitialJoaoBox"},{"Key":"y>3","Value":"InitialJoaoBoxNoMainSave"},{"Key":"JIH","Value":"StartingSuitSlots"},{"Key":"GO5","Value":"StartingSuitTechSlots"},{"Key":"g9F","Value":"StartingSuitCargoSlots"},{"Key":"@lX","Value":"WeaponSeed"},{"Key":"3R<","Value":"ShipSeed"},{"Key":"eEU","Value":"ShipClass"},{"Key":"bLP","Value":"ShipType"},{"Key":"dn2","Value":"StartWithFreighter"},{"Key":"fH7","Value":"FreighterBaseOverrideFilename"},{"Key":"RqY","Value":"FreighterRace"},{"Key":"oBB","Value":"StartAboardFreighter"},{"Key":"30;","Value":"ForceStartSystemTernary"},{"Key":"LDi","Value":"ForceStartSystemAbandoned"},{"Key":"XJC","Value":"IntroSequencePOI"},{"Key":"OMO","Value":"ValidSpawnBuildings"},{"Key":"CKb","Value":"WeaponInventoryLayout"},{"Key":"7jW","Value":"ShipInventoryLayout"},{"Key":"sNc","Value":"ShipTechInventoryLayout"},{"Key":"YNb","Value":"UseDefaultAppearance"},{"Key":"RFT","Value":"SlotItemFilterIDs"},{"Key":";EL","Value":"SeasonTransferInventoryConfig"},{"Key":"SDg","Value":"UseRandomPet"},{"Key":"4In","Value":"CreatureId"},{"Key":"HXT","Value":"MinRelativeScale"},{"Key":"UVd","Value":"MaxRelativeScale"},{"Key":"lFr","Value":"SpecificBiome"},{"Key":"DqZ","Value":"StartingTrust"},{"Key":"amP","Value":"TimeSinceLastEgg"},{"Key":"0xI","Value":"TimeSinceBirth"},{"Key":"qfQ","Value":"RandomPetConstraints"},{"Key":";4P","Value":"SpecificPets"},{"Key":"bv;","Value":"StartingPetSlots"},{"Key":"6AJ","Value":"PackedUA"},{"Key":"<R1","Value":"Timer"},{"Key":"j4j","Value":"SpawnChance"},{"Key":"qs?","Value":"SandwormOverrides"},{"Key":"O?u","Value":"SandwormGlobalOverride"},{"Key":"7fn","Value":"SandwormGlobalOverrideTimer"},{"Key":";MW","Value":"SandwormGlobalOverrideSpawnChance"},{"Key":"bnC","Value":"StartNextToShip"},{"Key":"Qwu","Value":"ShipIsAtDifferentBuildingToPlayer"},{"Key":"K2j","Value":"DistanceFromShipAtStartOfGame"},{"Key":"HtR","Value":"BuildingRadiusShipOffsetMultiplier"},{"Key":"jA9","Value":"ShipStartsDamaged"},{"Key":"Tx@","Value":"BlockStormsAtStart"},{"Key":"12H","Value":"BlockAggressiveSentinelsInStartSystem"},{"Key":"5XZ","Value":"AllowMissionDetailMessages"},{"Key":"EG=","Value":"UseStartPlanetObjectListOverrides"},{"Key":"apf","Value":"StartPlanetRareSubstanceOverride"},{"Key":"sti","Value":"TrashInventoryOnGalaxyTravel"},{"Key":"Pqk","Value":"FreighterBattleEarlyWarpsOverride"},{"Key":"5PB","Value":"ForceDeepSpaceAmbientFrigatesOnInfested"},{"Key":"pxy","Value":"TechCostMultiplier"},{"Key":"iBI","Value":"NeverLearnableTech"},{"Key":"3NI","Value":"ForgottenProducts"},{"Key":"ho8","Value":"IncreaseXClassTechOddsWithCommTier"},{"Key":"4Os","Value":"AbandonedFreighterHazardProtectionMul"},{"Key":"Z8l","Value":"FarmPlantsTimerMul"},{"Key":"e4G","Value":"HazardProtectionDrainMultiplier"},{"Key":"G4i","Value":"EnergyDrainMultiplier"},{"Key":"q5B","Value":"QuestSubstanceReducer"},{"Key":"JRE","Value":"TitleUpper"},{"Key":"ZNr","Value":"DescriptionDone"},{"Key":"5Xr","Value":"CantRewardMessage"},{"Key":"yID","Value":"IdToUseInMissionData"},{"Key":"6bD","Value":"StageIndex"},{"Key":">p0","Value":"MilestoneIndex"},{"Key":"TwN","Value":"RendezvousIndex"},{"Key":"DhC","Value":"Icon"},{"Key":"iGZ","Value":"IconGrey"},{"Key":"8rm","Value":"MissionIcon"},{"Key":"pBH","Value":"MissionIconSelected"},{"Key":"hxI","Value":"MissionIconNotSelected"},{"Key":"SI8","Value":"Reward"},{"Key":"X;?","Value":"RewardSwitchAlt"},{"Key":"I;n","Value":"RewardDescription"},{"Key":"iMl","Value":"CantClaimRewardDescription"},{"Key":"WmI","Value":"IsOptional"},{"Key":":?x","Value":"GreyIfCantStart"},{"Key":"Vd<","Value":"IsRendezvous"},{"Key":"leC","Value":"IsStageControl"},{"Key":"he5","Value":"BlockRendezvousMilestoneSeed"},{"Key":"@;C","Value":"DontAttemptFallbackTextSubs"},{"Key":"Y7c","Value":"IsEncrypted"},{"Key":"YFE","Value":"Patch"},{"Key":"Ujq","Value":"HoverPopupIcon"},{"Key":"pdE","Value":"DecryptMissionId"},{"Key":"IsL","Value":"DecryptMissionSeed"},{"Key":"6BQ","Value":"Encryption"},{"Key":"kr6","Value":"Milestones"},{"Key":"3Mw","Value":"Stages"},{"Key":"8d9","Value":"ForceInteraction"},{"Key":"KO>","Value":"InteractionType"},{"Key":"m5Q","Value":"ForceInteractionType"},{"Key":"MMA","Value":"RequireInteractionRace"},{"Key":"U:h","Value":"OverrideInteractionRace"},{"Key":"nS>","Value":"MustMatchStoryUtilityPuzzle"},{"Key":"K>D","Value":"ForceBroken"},{"Key":"qS7","Value":"ForceFixed"},{"Key":"RI1","Value":"ForceOverridesAll"},{"Key":"080","Value":"ForceOverrideEncounter"},{"Key":"rbc","Value":"IsCommunityPortalOverride"},{"Key":"hy2","Value":"ClearForcedInteractionOnCompletion"},{"Key":":3V","Value":"BuildingPreventionRadius"},{"Key":"me6","Value":"UseMissionTradingDataOverride"},{"Key":"wd3","Value":"AlwaysShow"},{"Key":"F0A","Value":"NeverShow"},{"Key":"4q6","Value":"ShowOnlyIfSequenceTarget"},{"Key":"WC1","Value":"PlanetLabelText"},{"Key":"?MX","Value":"SurveyDistance"},{"Key":"pG4","Value":"SurveyDiscoveryOSDMessage"},{"Key":"EWh","Value":"EventStartType"},{"Key":"J9A","Value":"EventEndType"},{"Key":"<ON","Value":"EventPriority"},{"Key":"apE","Value":"CanEndFromOutsideMission"},{"Key":"4AU","Value":"DisableMultiplayerSync"},{"Key":">iu","Value":"BlockStartedOnUseEvents"},{"Key":"lx1","Value":"ReplaceEventIfAlreadyActive"},{"Key":"a0>","Value":"BuildingType"},{"Key":"U9U","Value":"AllowFriendsBases"},{"Key":"gGT","Value":"ForceWideRandom"},{"Key":"7Ej","Value":"MustFindSystem"},{"Key":"S9I","Value":"AllowOverriddenBuildings"},{"Key":"dAR","Value":"TargetMustMatchMissionSeed"},{"Key":"TRs","Value":"SolarSystemLocation"},{"Key":"CT3","Value":"UseStarType"},{"Key":"Vc6","Value":"UseWealth"},{"Key":"8eX","Value":"UseTrading"},{"Key":"uog","Value":"UseRace"},{"Key":"NPd","Value":"GalaxyStarAnomaly"},{"Key":"HnX","Value":"UseAnomaly"},{"Key":"AFe","Value":"ConflictLevel"},{"Key":"kOi","Value":"UseConflict"},{"Key":"RCa","Value":"GalaxyStarType"},{"Key":"2Df","Value":"StarType"},{"Key":"yma","Value":"WealthClass"},{"Key":"0AL","Value":"TradingClass"},{"Key":"IpP","Value":"TradingData"},{"Key":"VOG","Value":"AllowUnsafeMatches"},{"Key":"q:;","Value":"NeverAllowEmpty"},{"Key":"x3h","Value":"NeverAllowAbandoned"},{"Key":"x5Z","Value":"RequireUndiscovered"},{"Key":"GcZ","Value":"NeedsWaterPlanet"},{"Key":"AeI","Value":"NeedsPrimePlanet"},{"Key":"L8=","Value":"NeedsSentinels"},{"Key":"waR","Value":"NeedsCorruptSentinelPlanet"},{"Key":"tV6","Value":"NeedsExtremeSentinelPlanet"},{"Key":"TG<","Value":"NeverAllowExtremeSentinelPlanet"},{"Key":"ObG","Value":"NeedsExtremeWeatherPlanet"},{"Key":"7tH","Value":"NeedsExtremeHazardPlanet"},{"Key":"mTG","Value":"AnyBiomeNotWeirdOrDead"},{"Key":"aZF","Value":"AnyRGBBiome"},{"Key":"rER","Value":"AnyInfestedBiome"},{"Key":"6<9","Value":"NeedsBiome"},{"Key":"5I<","Value":"NeedsBiomeType"},{"Key":"ulQ","Value":"BiomeSubType"},{"Key":"S>>","Value":"UseBiomeSubType"},{"Key":"a4X","Value":"NeedsEmptySystem"},{"Key":"C6D","Value":"NeedsAbandonedSystem"},{"Key":"cD>","Value":"NeedsResourceHint"},{"Key":"b>7","Value":"SuitableForCreatureDiscovery"},{"Key":"==:","Value":"SuitableForWeirdCreatureDiscovery"},{"Key":"g49","Value":"SuitableForCreatureTaming"},{"Key":"Ba0","Value":"SamePlanetAsEvent"},{"Key":"OHU","Value":"SamePlanetAsSeasonParty"},{"Key":"ecs","Value":"SolarSystemAttributes"},{"Key":"VZK","Value":"SolarSystemAttributesFallback"},{"Key":"DBn","Value":"ForceRestartInteraction"},{"Key":"V3H","Value":"HasReward"},{"Key":"<YE","Value":"NextOption"},{"Key":"Pf0","Value":"Range"},{"Key":"W8B","Value":"Triggers"},{"Key":"sY9","Value":"AllowRetrigger"},{"Key":"Y3<","Value":"TriggerActions"},{"Key":"0c7","Value":"UAsList"},{"Key":"2MH","Value":"TechnologyCategory"},{"Key":"aop","Value":"TechShopType"},{"Key":"3Ev","Value":"OSDMessage"},{"Key":"aGL","Value":"InterstellarOSDMessage"},{"Key":"1XT","Value":"MarkerLabel"},{"Key":"1MN","Value":"MarkerIcon"},{"Key":"Q6s","Value":"ScannerIconHighlightType"},{"Key":"Hr:","Value":"MissionMarkerHighlightStyleOverride"},{"Key":"9:T","Value":"MessageTime"},{"Key":"nx=","Value":"MessageDisplayTime"},{"Key":"D3X","Value":"MessageAudio"},{"Key":"7OD","Value":"IconTime"},{"Key":"Sbu","Value":"TooltipTime"},{"Key":"SnP","Value":"TooltipRepeats"},{"Key":"20F","Value":"ShowEndTooltip"},{"Key":"YE6","Value":"TooltipMessage"},{"Key":"gnU","Value":"MissionMessageOnInteract"},{"Key":"FKM","Value":"ResourceOverride"},{"Key":"QuE","Value":"ScanEventTable"},{"Key":"33J","Value":"ResetSaveOnDeath"},{"Key":"v>K","Value":"StatId"},{"Key":"<jc","Value":"StatsToPersistOnReset"},{"Key":"mVE","Value":"CompatibleWithState"},{"Key":"kPy","Value":"HasBeenConverted"},{"Key":"4=k","Value":"ID"},{"Key":"BBw","Value":"NameLower"},{"Key":"SCS","Value":"Teach"},{"Key":"i7<","Value":"HintStart"},{"Key":"gWW","Value":"HintEnd"},{"Key":"4Yf","Value":"Chargeable"},{"Key":"y=c","Value":"ChargeAmount"},{"Key":"J>I","Value":"SubstanceCategory"},{"Key":"uK<","Value":"ChargeType"},{"Key":"Gc7","Value":"ChargeBy"},{"Key":"cQc","Value":"ChargeMultiplier"},{"Key":"7dP","Value":"BuildFullyCharged"},{"Key":"67b","Value":"UsesAmmo"},{"Key":"02l","Value":"AmmoId"},{"Key":"qbd","Value":"PrimaryItem"},{"Key":"8L;","Value":"Upgrade"},{"Key":"3ol","Value":"Core"},{"Key":"WAV","Value":"RepairTech"},{"Key":"YIB","Value":"Procedural"},{"Key":"JC<","Value":"BrokenSlotTech"},{"Key":"LFj","Value":"Category"},{"Key":"UtG","Value":"TechnologyRarity"},{"Key":"hQ1","Value":"Rarity"},{"Key":"9J<","Value":"Requirements"},{"Key":"N=w","Value":"StatsType"},{"Key":"huR","Value":"BaseStat"},{"Key":"B29","Value":"Bonus"},{"Key":"txU","Value":"StatBonuses"},{"Key":"Ubj","Value":"RequiredTech"},{"Key":"nW;","Value":"RequiredLevel"},{"Key":"mRF","Value":"FocusLocator"},{"Key":"7pJ","Value":"UpgradeColour"},{"Key":"CX9","Value":"LinkColour"},{"Key":"753","Value":"RewardGroup"},{"Key":"GFy","Value":"BaseValue"},{"Key":"gsT","Value":"SpaceStationMarkup"},{"Key":"aS@","Value":"LowPriceMod"},{"Key":"TuK","Value":"HighPriceMod"},{"Key":"xFq","Value":"BuyBaseMarkup"},{"Key":"uEG","Value":"BuyMarkupMod"},{"Key":"s;F","Value":"Cost"},{"Key":"vnq","Value":"RequiredRank"},{"Key":">TS","Value":"DispensingRace"},{"Key":"2mY","Value":"FragmentCost"},{"Key":"Z@U","Value":"TechShopRarity"},{"Key":"QqY","Value":"WikiEnabled"},{"Key":"BQo","Value":"DamagedDescription"},{"Key":"ByQ","Value":"ParentTechId"},{"Key":"5;w","Value":"IsTemplate"},{"Key":"L6<","Value":"ExclusivePrimaryStat"},{"Key":"QKN","Value":"TechnologyTable"},{"Key":"33q","Value":"Hint"},{"Key":"S2k","Value":"GroupID"},{"Key":"@xZ","Value":"DebrisFile"},{"Key":"WoW","Value":"HeroIcon"},{"Key":"eem","Value":"ProductCategory"},{"Key":"MLJ","Value":"Legality"},{"Key":"l?S","Value":"Consumable"},{"Key":"TbT","Value":"ChargeValue"},{"Key":"Zq4","Value":"StackMultiplier"},{"Key":"TlS","Value":"DefaultCraftAmount"},{"Key":"W=G","Value":"CraftAmountStepSize"},{"Key":"@xT","Value":"CraftAmountMultiplier"},{"Key":"c=A","Value":"AltRequirements"},{"Key":"iBF","Value":"RecipeCost"},{"Key":"kOX","Value":"SpecificChargeOnly"},{"Key":"H:b","Value":"NormalisedValueOnWorld"},{"Key":"KxX","Value":"NormalisedValueOffWorld"},{"Key":"6:a","Value":"TradeCategory"},{"Key":"TOS","Value":"WikiCategory"},{"Key":"wFw","Value":"IsCraftable"},{"Key":"Ch:","Value":"DeploysInto"},{"Key":"VUh","Value":"EconomyInfluenceMultiplier"},{"Key":"H9K","Value":"PinObjective"},{"Key":"ec8","Value":"PinObjectiveTip"},{"Key":"XbO","Value":"PinObjectiveMessage"},{"Key":"Go<","Value":"ScanIconType"},{"Key":"pFl","Value":"PinObjectiveScannableType"},{"Key":"n5h","Value":"PinObjectiveEasyToRefine"},{"Key":"rHh","Value":"CookingIngredient"},{"Key":"e;b","Value":"CookingValue"},{"Key":"E?H","Value":"GoodForSelling"},{"Key":"LMQ","Value":"GiveRewardOnSpecialPurchase"},{"Key":"RxV","Value":"EggModifierIngredient"},{"Key":"YeP","Value":"IsTechbox"},{"Key":"uWE","Value":"CanSendToOtherPlayers"},{"Key":"bxn","Value":"ProductTable"},{"Key":"D8J","Value":"Symbol"},{"Key":"ZW9","Value":"WorldColour"},{"Key":"yX:","Value":"WikiMissionID"},{"Key":"7m<","Value":"EasyToRefine"},{"Key":"n>y","Value":"SubstanceTable"},{"Key":"KD8","Value":"AlwaysPresentProducts"},{"Key":"pwI","Value":"AlwaysPresentSubstances"},{"Key":";x>","Value":"OptionalProducts"},{"Key":";Ki","Value":"OptionalSubstances"},{"Key":"tLA","Value":"MinItemsForSale"},{"Key":";g=","Value":"MaxItemsForSale"},{"Key":"jZW","Value":"PercentageOfItemsAreProducts"},{"Key":"3V@","Value":"BuyPriceIncreaseRedThreshold"},{"Key":"LAt","Value":"BuyPriceDecreaseGreenThreshold"},{"Key":"?JH","Value":"SellPriceIncreaseGreenThreshold"},{"Key":"d<k","Value":"SellPriceDecreaseRedThreshold"},{"Key":"MwQ","Value":"ShowSeasonRewards"},{"Key":"ZM<","Value":"MinAmountOfProductAvailable"},{"Key":"Eh=","Value":"MaxAmountOfProductAvailable"},{"Key":"Rlk","Value":"MinAmountOfSubstanceAvailable"},{"Key":"AiZ","Value":"MaxAmountOfSubstanceAvailable"},{"Key":">54","Value":"MinExtraSystemProducts"},{"Key":"A14","Value":"MaxExtraSystemProducts"},{"Key":"K0h","Value":"TradeProductsPriceImprovements"},{"Key":"=:T","Value":"SeasonalUAStationTradeData"},{"Key":"fdE","Value":"UseSeasonalUAStationTradeData"},{"Key":"Rol","Value":"SeasonData"},{"Key":"psf","Value":"MilestoneValues"},{"Key":"aRZ","Value":"RewardCollected"},{"Key":"a=X","Value":"PinnedStage"},{"Key":"pK=","Value":"PinnedMilestone"},{"Key":":1n","Value":"RendezvousUAs"},{"Key":"erT","Value":"HasCollectedFinalReward"},{"Key":"OpM","Value":"Radius"},{"Key":";UQ","Value":"ProtectedLocations"},{"Key":"U6K","Value":"ProtectedEvents"},{"Key":"J=T","Value":"SeasonSaveStateOnDeath"},{"Key":"BZY","Value":"StateOnDeath"},{"Key":"Pug","Value":"SeasonTransferInventory"},{"Key":"khi","Value":"SeasonEndRewardsRedemptionState"},{"Key":"4K:","Value":"EndRewardsRedemptionState"},{"Key":"qYy","Value":"SeasonState"},{"Key":">KU","Value":"SeasonTransferInventoryData"},{"Key":"CJJ","Value":"EarnedSeasonSpecialRewards"},{"Key":"vLc","Value":"BaseContext"},{"Key":"2YS","Value":"ExpeditionContext"},{"Key":"6f=","Value":"PlayerStateData"},{"Key":"rnc","Value":"SpawnStateData"},{"Key":"VuQ","Value":"GameKnowledgeData"},{"Key":"fDu","Value":"DiscoveryManagerData"},{"Key":"ETO","Value":"DiscoveryData-v1"},{"Key":"Ft;","Value":"MultiTool"},{"Key":"yRy","Value":"Waypoints"},{"Key":"?fB","Value":"Record"},{"Key":"kVv","Value":"TSrec"},{"Key":"brV","Value":"Available"},{"Key":";FZ","Value":"Enqueued"},{"Key":"ksu","Value":"OWS"},{"Key":"f5Q","Value":"LID"},{"Key":"K7E","Value":"UID"},{"Key":"q9a","Value":"DM"},{"Key":"q5u","Value":"CN"},{"Key":"=wD","Value":"FL"},{"Key":"D6b","Value":"PTK"},{"Key":"V?r","Value":"H"},{"Key":"bLr","Value":"C"},{"Key":"tiH","Value":"U"},{"Key":"?6B","Value":"F"},{"Key":"8P3","Value":"DD"},{"Key":"<Dn","Value":"DT"},{"Key":"bEr","Value":"VP"},{"Key":"3I1","Value":"TS"},{"Key":"V?:","Value":"USN"},{"Key":"B89","Value":"UserSettingsData"},{"Key":"32m","Value":"InvertLookControls"},{"Key":"TTp","Value":"InvertFlightControls"},{"Key":"17F","Value":"InvertVRInWorldFlightControls"},{"Key":":QA","Value":"VRVehiclesUseWorldControls"},{"Key":"iWq","Value":"HUDHidden"},{"Key":"qR4","Value":"Vibration"},{"Key":"BYa","Value":"ScreenBrightness"},{"Key":"bfl","Value":"MusicVolume"},{"Key":"vSL","Value":"SfxVolume"},{"Key":"xJl","Value":"LookSensitivityMode1"},{"Key":"LS;","Value":"LookSensitivityMode2"},{"Key":"s5u","Value":"FlightSensitivityMode1"},{"Key":"Ex3","Value":"FlightSensitivityMode2"},{"Key":"t0q","Value":"CursorSensitivityMode1"},{"Key":";b<","Value":"CursorSensitivityMode2"},{"Key":"@R8","Value":"MouseSpringSmoothing"},{"Key":"NpS","Value":"UserId"},{"Key":"pki","Value":"BlockedUserArray"},{"Key":"qW=","Value":"NextSlot"},{"Key":"9>M","Value":"ListSize"},{"Key":"eLF","Value":"MessageId"},{"Key":"156","Value":"BlockedMessageArray"},{"Key":"hQ2","Value":"MessageNextSlot"},{"Key":"Srq","Value":"MessageListSize"},{"Key":"8rR","Value":"BlockList"},{"Key":"53F","Value":"MotionBlurAmount"},{"Key":"J7m","Value":"DamageNumbers"},{"Key":"XG3","Value":"PS4FixedFPS"},{"Key":"XvB","Value":"PS4FOVFoot"},{"Key":"8im","Value":"PS4FOVShip"},{"Key":"9hL","Value":"XboxOneXHighResolutionMode"},{"Key":"u=o","Value":"PS4VignetteAndScanlines"},{"Key":"TwH","Value":"BaseSharingMode"},{"Key":"bLB","Value":"SeenSubstances"},{"Key":">Qn","Value":"SeenTechnologies"},{"Key":"B1h","Value":"SeenProducts"},{"Key":"b1D","Value":"SeenWikiTopics"},{"Key":"aZ4","Value":"UnlockedWikiTopics"},{"Key":"Bgb","Value":"UnlockedTitles"},{"Key":"fyX","Value":"UnlockedSpecials"},{"Key":"d4U","Value":"UnlockedSeasonRewards"},{"Key":"<5B","Value":"UnlockedTwitchRewards"},{"Key":"xop","Value":"UnlockedPlatformRewards"},{"Key":"glF","Value":"VoiceChat"},{"Key":"O9v","Value":"Multiplayer"},{"Key":"2L7","Value":"InstantUIInputs"},{"Key":"wYX","Value":"InstantUIDelete"},{"Key":"Kcb","Value":"SpeechToText"},{"Key":"@S5","Value":"Translate"},{"Key":"eA4","Value":"CrossPlatform"},{"Key":"se1","Value":"TemperatureUnit"},{"Key":"thy","Value":"UseOldMouseFlight"},{"Key":"wme","Value":"LastSeenCommunityMission"},{"Key":"LmG","Value":"LastSeenCommunityMissionTier"},{"Key":":P<","Value":"MovementMode"},{"Key":"b9N","Value":"MovementDirection"},{"Key":"K9K","Value":"MovementDirectionPad"},{"Key":"OX4","Value":"MovementDirectionHands"},{"Key":"Cca","Value":"EnableControllerCursorInVR"},{"Key":";0c","Value":"BaseBuildingShowOptionsFromVision"},{"Key":"<1t","Value":"TurnMode"},{"Key":"Zv>","Value":"VRVignetteStrength"},{"Key":"Gs0","Value":"UseShipAutoControlVignette"},{"Key":"90=","Value":"HUDZoom"},{"Key":"?IX","Value":"FrontendZoom"},{"Key":"gBT","Value":"UseAutoTorch"},{"Key":"mny","Value":"UIColourScheme"},{"Key":"Ffw","Value":"EnableModdingConsole"},{"Key":"mTk","Value":"HeadBob"},{"Key":"wOy","Value":"VRHeadBob"},{"Key":"oLD","Value":"VRShowBody"},{"Key":"kjc","Value":"UseCharacterHeightForCamera"},{"Key":"cKb","Value":"BaseComplexityLimitsEnabled"},{"Key":"s4Q","Value":"EnableLargeLobbies"},{"Key":"V86","Value":"FireteamSessionCount"},{"Key":"RpZ","Value":"HeadsetVibrationStrength"},{"Key":":@U","Value":"VibrationStrength"},{"Key":"rfa","Value":"CamerShakeStrength"},{"Key":"N4>","Value":"TriggerFeedbackStrength"},{"Key":"fkY","Value":"SpaceCombatFollowMode"},{"Key":"eRg","Value":"UpgradedUsers"},{"Key":":aT","Value":"AllowWhiteScreenTransitions"},{"Key":"Y4Z","Value":"AccessibleText"},{"Key":"1l?","Value":"AutoScanDiscoveries"},{"Key":"qWL","Value":"SprintScanSwap"},{"Key":"GrC","Value":"PlaceJumpSwap"},{"Key":"78s","Value":"EyeTrackingFlags"},{"Key":"e=?","Value":"MoveableWristMenus"},{"Key":"HKJ","Value":"GyroEnabled"},{"Key":"=Kk","Value":"GyroEnabledHandheld"},{"Key":"Yfy","Value":"ActiveModeOnFoot"},{"Key":"pn3","Value":"AllowWhenRidingCreatures"},{"Key":"PWT","Value":"ActiveModeWhenBuilding"},{"Key":"38j","Value":"EnableGyroInBuildingFreeCam"},{"Key":"UXE","Value":"ActiveModeInExocraft"},{"Key":"w11","Value":"LookStickEnabled"},{"Key":"Bc0","Value":"GyroCursorEnabled"},{"Key":"CrY","Value":"CursorSensitivityX"},{"Key":"kUN","Value":"CursorSensitivityY"},{"Key":"Hn;","Value":"CursorTighteningThreshold"},{"Key":"5ng","Value":"CursorLookStickEnabled"},{"Key":"QX9","Value":"Handedness"},{"Key":"hDM","Value":"SensitivityX"},{"Key":"RJ1","Value":"SensitivityY"},{"Key":"h=L","Value":"Steadying"},{"Key":"bX9","Value":"Acceleration"},{"Key":">a:","Value":"EnableAdvancedOptions"},{"Key":"mtC","Value":"ScopeMultiplier"},{"Key":"h1;","Value":"AimingMultiplier"},{"Key":"rmy","Value":"ExocraftMultiplier"},{"Key":"IoV","Value":"BuildingMultiplier"},{"Key":"vUG","Value":"ZoomScalesSensitivity"},{"Key":"2X7","Value":"GyroRotationSpace"},{"Key":"PMG","Value":"GyroRotationSpaceHandheld"},{"Key":"gc5","Value":"YawAxisDirection"},{"Key":"2NR","Value":"RollAxisDirection"},{"Key":"R>5","Value":"PitchAxisDirection"},{"Key":"sIs","Value":"SmoothingThreshold"},{"Key":"<lM","Value":"SmoothingWindow"},{"Key":"GVU","Value":"TighteningThreshold"},{"Key":"18k","Value":"Deadzone"},{"Key":"6bF","Value":"FilterControllerVibrations"},{"Key":"XSf","Value":"GyroSettings"},{"Key":"Fth","Value":"Language"},{"Key":"quD","Value":"AutoRotateThirdPersonPlayerCamera"},{"Key":"BZB","Value":"Hand"},{"Key":"svY","Value":"DominantHand"},{"Key":"9N3","Value":"HazardEffectsStrength"},{"Key":"397","Value":"QuickMenuBuildMenuSwap"},{"Key":"GJc","Value":"HighResVRUI"},{"Key":";HB","Value":"PlayerHUDVROffset"},{"Key":"34i","Value":"ShipHUDVROffset"},{"Key":"SCv","Value":"HighlightInteractableObjects"},{"Key":"Oyu","Value":"VRHandControllerSwapYawAndRoll"},{"Key":"Zme","Value":"VRHandControllerEnableTwist"}]}

    @staticmethod
    def pathChecks(files: list[str]) -> list[str]:
        filtered_files = []
        for path in files:
            file_name = os.path.basename(path)
            if file_name.lower().endswith(".hg") and "savedata" in file_name.lower():
                filtered_files.append(path)
        return filtered_files
    
    @staticmethod
    def nameCheck(path: str) -> bool:
        file_name = os.path.basename(path).lower()
        return file_name.endswith(".hg") and "savedata" in file_name

    @staticmethod
    def load_keys(operation: Literal["DECODE", "ENCODE"]) -> dict[str, str]:
        """Create a dict with the obfuscation keys, the key is what to check for, value is what to replace."""
        keys = {}
        for pair in Crypt_NMS.OBFUSCATION["Mapping"]:
            if operation == "DECODE":
                keys[pair["Key"]] = pair["Value"]
            else:
                keys[pair["Value"]] = pair["Key"]
        return keys
    
    @staticmethod
    def map_keys(node: Any, mapping: dict[str, str], result: dict[str, Any] | None = None) -> dict[str, Any]:
        """Replace the obfuscated keys with the value in the mapping parameter."""
        if result is None:
            result = {}

        if isinstance(node, dict):
            for key, val in node.items():
                if key in mapping:
                    result[mapping[key]] = val 

                if isinstance(val, (dict, list)):
                    new_result = {}
                    result[mapping[key]] = Crypt_NMS.map_keys(val, mapping, new_result)
                else:
                    result[mapping[key]] = val

        elif isinstance(node, list):
            result = []
            for item in node:
                if isinstance(item, (dict, list)):
                    new_result = {}
                    result.append(Crypt_NMS.map_keys(item, mapping, new_result))
                else:
                    result.append(item)

        return result

    @staticmethod
    def deobfuscate(data: bytes | bytearray) -> bytes:
        data = data.rstrip(b"\x00")
        try:
            data = data.decode("utf-8")
        except UnicodeDecodeError:
            raise CryptoError("Could not deobfuscate savegame: failed to decode to utf-8.")
        
        mapping = Crypt_NMS.load_keys(operation="DECODE")
       
        dict_data = json.loads(data)
        mapped_data = Crypt_NMS.map_keys(dict_data, mapping)

        return json.dumps(mapped_data, separators=(",", ":")).encode("utf-8")
    
    @staticmethod
    def obfuscate(data: bytes | bytearray) -> bytes:
        data = data.rstrip(b"\x00")
        try:
            data = data.decode("utf-8")
        except UnicodeDecodeError:
            raise CryptoError("Could not obfuscate savegame: failed to decode to utf-8.")

        mapping = Crypt_NMS.load_keys(operation="ENCODE")

        dict_data = json.loads(data)
        mapped_data = Crypt_NMS.map_keys(dict_data, mapping)

        return json.dumps(mapped_data, separators=(",", ":")).encode("utf-8")

    @staticmethod
    def decompress(data: bytes | bytearray) -> bytearray:
        magic = struct.pack("<I", Crypt_NMS.LZ4_MAGIC)
        decomp = bytearray()
        
        pointer = 0
        while True:
            off = data.find(magic, pointer)
            if off == -1:
                break
            pointer = off + 4
            
            compsize = data[pointer:pointer + 4]
            compsize = struct.unpack("<I", compsize)[0]
            
            pointer += 4

            decompsize = data[pointer:pointer + 4]
            decompsize = struct.unpack("<I", decompsize)[0]

            pointer += 8

            chunk_data = data[pointer:pointer + compsize]
            chunk = lz4.block.decompress(chunk_data, uncompressed_size=decompsize)

            decomp.extend(chunk)
        return decomp
    
    @staticmethod
    def compress(data: bytes | bytearray) -> bytearray:
        magic = struct.pack("<I", Crypt_NMS.LZ4_MAGIC)
        null = b"\x00\x00\x00\x00"
        comp = bytearray()

        pointer = 0
        while True:
            chunk = data[pointer:pointer + Crypt_NMS.CHUNK_SIZE]
            if not chunk:
                break

            decompsize = len(chunk)

            compchunk = lz4.block.compress(chunk, store_size=False)
            compsize = len(compchunk)

            header = magic + struct.pack("<II", compsize, decompsize) + null

            comp_data = header + compchunk

            comp.extend(comp_data)
            pointer += decompsize
        return comp

    @staticmethod
    async def decryptFile(folderPath: str) -> None:
        unfiltered_files = await CustomCrypto.obtainFiles(folderPath)
        filtered_files = Crypt_NMS.pathChecks(unfiltered_files)

        for filePath in filtered_files:
            
            async with aiofiles.open(filePath, "rb") as savegame:
                compressed_data = await savegame.read()

            uncompressed_data = Crypt_NMS.decompress(compressed_data)
            deobfuscated_data = Crypt_NMS.deobfuscate(uncompressed_data)

            async with aiofiles.open(filePath, "wb") as savegame:
                await savegame.write(deobfuscated_data)
    
    @staticmethod
    async def encryptFile(fileToEncrypt: str) -> None:
        if not Crypt_NMS.nameCheck(fileToEncrypt):
            return

        async with aiofiles.open(fileToEncrypt, "rb") as savegame:
            uncompressed_data = await savegame.read()

        obfuscated_data = Crypt_NMS.obfuscate(uncompressed_data)
        compressed_data = Crypt_NMS.compress(obfuscated_data)

        async with aiofiles.open(fileToEncrypt, "wb") as savegame:
            await savegame.write(compressed_data)

    @staticmethod
    async def checkEnc_ps(fileName: str) -> None:
        if not Crypt_NMS.nameCheck(fileName):
            return

        async with aiofiles.open(fileName, "rb") as savegame:
            data = await savegame.read()
        
        start_off = data.find(struct.pack("<I", Crypt_NMS.LZ4_MAGIC))
        if start_off == -1:
            await Crypt_NMS.encryptFile(fileName)